<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ—¥çµŒ225ã‚¹ãƒãƒ¼ãƒˆAIåˆ†æ</title>

  <!-- å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ -->
  <!-- Lightweight Charts: é«˜æ€§èƒ½ãªãƒãƒ£ãƒ¼ãƒˆæç”»ãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
  <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
  <!-- marked: AIã‹ã‚‰ã®Markdownå›ç­”ã‚’HTMLã«å¤‰æ› -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- Server-side PDF export enabled -->
  
  <!-- è‡ªä½œJavaScriptï¼ˆdeferã‚’ä»˜ã‘ã¦DOMæ§‹ç¯‰å¾Œã«å®Ÿè¡Œï¼‰ -->
  <script src="{{ url_for('static', filename='script.js') }}" defer></script>

  <style>
    /* ğŸ¨ å…¨ä½“ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
    body { font-family: sans-serif; margin: 20px; background-color: #f9f9f9; color: #333; }
    h2 { margin-bottom: 10px; }
    
    /* ğŸ“ˆ ãƒãƒ£ãƒ¼ãƒˆã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    #chart { width: 100%; max-width: 1200px; height: 400px; margin-top: 10px; background: #fff; }
    #kairiChart { width: 100%; max-width: 1200px; height: 150px; margin-top: 10px; background: #fff; }
    
    /* ğŸ› ï¸ æ“ä½œãƒ‘ãƒãƒ«ï¼ˆæ¥­ç¨®ãƒ»éŠ˜æŸ„é¸æŠï¼‰ */
    .controls { margin-bottom: 20px; padding: 15px; background: #fff; border: 1px solid #ddd; border-radius: 8px; }
    label { font-weight: bold; margin-right: 5px; }
    select { padding: 5px; margin-right: 20px; border-radius: 4px; border: 1px solid #ccc; }
    
    /* ğŸ“Š å‡¡ä¾‹ï¼ˆç§»å‹•å¹³å‡ç·šã®è‰²èª¬æ˜ï¼‰ */
    .legend { list-style: none; padding: 0; font-size: 0.9em; color: #555; margin-bottom: 15px; display: flex; gap: 15px; }

    /* ğŸ¤– AIåˆ†æã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ãƒœã‚¿ãƒ³ */
    .analysis-section { margin-top: 30px; }
    .analyze-area {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }
    
    /* ğŸ”„ ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã®ãƒ¢ãƒ€ãƒ³ãªã‚¹ã‚¿ã‚¤ãƒ« */
    #loading-container {
      display: none;
      width: 100%;
      padding: 15px;
      background: #eef7ff;
      border-radius: 8px;
      margin: 10px 0;
      border-left: 5px solid #0078d7;
      animation: pulse 2s infinite ease-in-out;
    }
    @keyframes pulse {
      0% { opacity: 0.6; }
      50% { opacity: 1; }
      100% { opacity: 0.6; }
    }
    .loading-content {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .loader {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #0078d7;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* ğŸ“ Markdownå‡ºåŠ›ã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    #analysisResult {
      background: #fff;
      padding: 25px;
      border: 1px solid #ddd;
      border-radius: 8px;
      line-height: 1.8;
      color: #333;
      min-height: 100px;
    }
    #analysisResult h1, #analysisResult h2, #analysisResult h3 {
      border-bottom: 1px solid #eee;
      padding-bottom: 5px;
      margin-top: 1.2em;
    }
    
    /* --- ğŸ”˜ åˆ†æãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆã‚¿ãƒ–ã®ã‚¹ã‚¿ã‚¤ãƒ« --- */
    .analysis-tabs {
      display: flex;
      gap: 5px;
      margin-bottom: 10px;
    }
    .tab-btn {
      padding: 8px 16px;
      background: #eee;
      border: 1px solid #ddd;
      border-radius: 5px 5px 0 0;
      cursor: pointer;
      font-weight: bold;
      color: #666;
      transition: all 0.3s;
    }
    .tab-btn.active {
      background: #fff;
      border-bottom: 2px solid #0078d7;
      color: #0078d7;
    }
    .tab-btn:hover:not(.active) {
      background: #e5e5e5;
    }

    /* ğŸŒ å¸‚æ³åˆ†æãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    #market-form-area {
      display: none;
      background: #fff;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 0 0 8px 8px;
      margin-top: -10px;
      margin-bottom: 20px;
      animation: fadeIn 0.3s;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .market-category { margin-bottom: 15px; }
    .market-category h4 { margin: 0 0 8px 0; color: #555; font-size: 0.95em; border-left: 4px solid #0078d7; padding-left: 8px; }
    .market-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 8px; font-size: 0.9em; }
    .market-grid label { display: flex; align-items: center; gap: 5px; cursor: pointer; }
    .market-grid label:hover { color: #0078d7; }

    /* â“ ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ï¼ˆãƒ˜ãƒ«ãƒ—ãƒãƒ¼ã‚¯ï¼‰ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .help-icon {
      display: inline-block;
      width: 15px;
      height: 15px;
      line-height: 15px;
      text-align: center;
      border-radius: 50%;
      background-color: #0078d7;
      color: #fff;
      font-size: 11px;
      cursor: help;
      margin-left: 4px;
      position: relative;
      vertical-align: middle;
    }
    .help-icon::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(51, 51, 51, 0.95);
      color: #fff;
      padding: 10px 14px;
      border-radius: 6px;
      width: 400px;
      max-width: 95vw;
      font-size: 11px;
      font-weight: normal;
      line-height: 1.6;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.2s;
      z-index: 1000;
      white-space: pre-line;
      text-align: left;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      pointer-events: none;
    }
    .help-icon:hover::after {
      visibility: visible;
      opacity: 1;
    }
    .help-icon.bottom::after { bottom: auto; top: 125%; }

  /* ğŸ“ æŠ˜ã‚ŠãŸãŸã¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
  details summary { cursor: pointer; font-weight: bold; color: #555; font-size: 0.9em; margin: 10px 0; outline: none; list-style: none; }
  details summary::-webkit-details-marker { display: none; } /* Safariç­‰ç”¨ */
  .details-content { padding: 10px; border: 1px solid #eee; border-radius: 5px; background: #fafafa; }

  /* ğŸ“œ åˆ†æå±¥æ­´ã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ« */
  .history-item {
    transition: all 0.2s ease;
    cursor: pointer;
  }
  .history-item:hover {
    background-color: #f0f7ff;
    border-color: #0078d7 !important;
    transform: translateX(5px);
  }
  .history-item.active {
    border-left: 5px solid #0078d7 !important;
    background-color: #f0f7ff;
  }
  .history-select-container {
    display: flex;
    align-items: center;
    padding: 0 15px;
    border-right: 1px solid #eee;
    background: #f8f9fa;
  }
  .history-content-link {
    flex-grow: 1;
    padding: 12px 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  /* ğŸš€ å®Ÿè¡Œãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« (ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã§å¼·èª¿) */
    .run-analysis-trigger {
      padding: 12px 30px;
      background: linear-gradient(135.22deg, #0078d7 0%, #0056b3 100%);
      color: white;
      border: none;
      border-radius: 50px; /* ä¸¸ã¿ã®ã‚ã‚‹ãƒ¢ãƒ€ãƒ³ãªãƒœã‚¿ãƒ³ */
      cursor: pointer;
      font-weight: bold;
      font-size: 1.1em;
      letter-spacing: 1px;
      box-shadow: 0 4px 15px rgba(0,120,215,0.3);
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      position: relative;
      overflow: hidden;
    }
    .run-analysis-trigger::before {
      content: '';
      position: absolute;
      top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(120deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: all 0.6s;
    }
    .run-analysis-trigger:hover:not(:disabled) {
      background: linear-gradient(135.22deg, #0086f0 0%, #0062cc 100%);
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 6px 20px rgba(0,120,215,0.4);
    }
    .run-analysis-trigger:hover:not(:disabled)::before {
      left: 100%;
    }
    .run-analysis-trigger:active:not(:disabled) {
      transform: translateY(1px);
      box-shadow: 0 2px 10px rgba(0,120,215,0.3);
    }
    .run-analysis-trigger:disabled {
      background: #bdc3c7 !important; /* æ˜ç¢ºãªç°è‰² */
      color: #ecf0f1;
      cursor: not-allowed;
      transform: none !important;
      box-shadow: none !important;
      opacity: 0.8;
    }

    button:hover { opacity: 0.8; }
  </style>
</head>

<body>
  <!-- ğŸ† ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header style="background-color: #1a237e; color: white; padding: 20px; text-align: center; margin-bottom: 20px; border-bottom: 4px solid #ffd700;">
      <h1 style="margin: 0; font-size: 28px; letter-spacing: 2px;">æ—¥çµŒ225ã‚¹ãƒãƒ¼ãƒˆAIåˆ†æ</h1>
      <p style="margin: 5px 0 0; font-size: 14px; opacity: 0.8;">Advanced AI All-round Analysis</p>
  </header>

<div class="container">
  <!-- ğŸ› ï¸ éŠ˜æŸ„é¸æŠãƒ»å±¥æ­´ -->
  <div class="controls">
    <label for="industrySelect">æ¥­ç¨®ï¼š</label>
    <select id="industrySelect">
      <option value="all">ã™ã¹ã¦ã®æ¥­ç¨®</option>
      {% for industry in industries %}
        <option value="{{ industry }}">{{ industry }}</option>
      {% endfor %}
    </select>

    <label for="stockSelect">éŠ˜æŸ„ï¼š</label>
    <select id="stockSelect">
      <option value="">éŠ˜æŸ„ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
    </select>

    <div id="recentContainer" style="margin-top: 10px;">
      <label style="font-size: 0.85em; color: #666;">æœ€è¿‘è¦‹ãŸéŠ˜æŸ„ï¼š</label>
      <div id="recentList" style="display: inline-flex; gap: 5px; flex-wrap: wrap; vertical-align: middle;">
        <!-- JSã§ãƒœã‚¿ãƒ³ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ -->
      </div>
    </div>
  </div>

  <!-- ğŸ“ˆ æ ªä¾¡çµ±è¨ˆãƒ»ãƒ•ã‚¡ãƒ³ãƒ€ãƒ¡ãƒ³ã‚¿ãƒ«ã‚ºæƒ…å ±è¡¨ç¤ºãƒ‘ãƒãƒ« -->
  <div id="stockStats" style="display:none; background:#fff; padding:15px; border:1px solid #ddd; border-radius:8px; margin-bottom:15px; display: flex; gap: 20px; flex-wrap: wrap; align-items: stretch;">
    <div style="flex:1; min-width:300px;">
      <h4 style="margin:0 0 12px 0; border-bottom: 2px solid #eee; padding-bottom: 5px; color: #555;">
          ğŸ“ˆ åŸºæœ¬çµ±è¨ˆ (ç›´è¿‘ã®å€¤)
          <span class="help-icon" data-tooltip="â€»å„æƒ…å ±ã¯éå»ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦è¡¨ç¤ºã—ã¦ã„ã‚‹ã®ã§ï¼Œèª¤ã‚Šã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚">?</span>
      </h4>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9em;">
        <div>æ™‚ä¾¡ç·é¡: <b id="statCap">--</b></div>
        <div>åˆ©å›ã‚Š: <b id="statDiv">--</b></div>
        <div>PER: <b id="statPER">--</b></div>
        <div>PBR: <b id="statPBR">--</b></div>
        <div>ROE: <b id="statROE">--</b></div>
        <div>ROA: <b id="statROA">--</b></div>
        <div>é…å½“æ€§å‘: <b id="statPayout">--</b></div>
        <div>é…å½“è½ã¡æ—¥: <b id="statExDiv">--</b></div>
      </div>
      <div style="margin-top: 12px; display: flex; gap: 15px; font-size: 0.9em; border-top: 1px dashed #eee; padding-top: 10px;">
        <span>æœ€é«˜å€¤: <span id="statMax" style="font-weight:bold; color:red;">-</span></span>
        <span>æœ€å®‰å€¤: <span id="statMin" style="font-weight:bold; color:blue;">-</span></span>
      </div>
    </div>
    <div style="flex:2; min-width:450px; background: #fff; padding: 10px; border-radius: 6px; border: 1px solid #eee;">
      <h4 style="margin:0 0 10px 0; border-bottom: 2px solid #1a237e; padding-bottom: 5px;">ğŸ¢ AIã«ã‚ˆã‚‹ä¼šç¤¾èª¬æ˜</h4>
      <div id="companyInfoContent" style="font-size: 0.85em; line-height: 1.6; color: #444;">
          éŠ˜æŸ„ã‚’é¸æŠã™ã‚‹ã¨AIãŒä¼šç¤¾æ¦‚è¦ã‚’èª¿æŸ»ã—ã¾ã™...
      </div>
      <!-- éš ã—è¦ç´ ã¨ã—ã¦å‡ºæ¥é«˜ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒï¼ˆåˆ†ææ©Ÿèƒ½ç”¨ï¼‰ -->
      <ul id="statVolRanking" style="display: none;"></ul>
    </div>
  </div>
  
  <!-- ğŸ—ºï¸ å‡¡ä¾‹ -->
  <ul class="legend">
    <li>ãƒ¡ã‚¤ãƒ³ãƒãƒ£ãƒ¼ãƒˆï¼š<span style="color:green">â—</span> 5SMA / <span style="color:red">â—</span> 25SMA / <span style="color:blue">â—</span> 75SMA</li>
    <li>ã‚µãƒ–ï¼š<span style="color:purple">â—</span> 25æ—¥ä¹–é›¢ç‡</li>
  </ul>

  <!-- ğŸ–±ï¸ ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã®æ ªä¾¡è©³ç´°ï¼ˆOHLCï¼‰è¡¨ç¤º -->
  <div id="ohlc-display" style="margin-bottom: 5px; font-family: monospace; font-size: 14px; background: #f8f9fa; padding: 5px; border-radius: 4px; border: 1px solid #ddd;">
    æ—¥ä»˜: -- å§‹å€¤: -- é«˜å€¤: -- å®‰å€¤: -- çµ‚å€¤: -- é¨°è½ç‡: --
  </div>

  <!-- ğŸ“Š ãƒãƒ£ãƒ¼ãƒˆæœ¬ä½“ -->
  <div id="chart"></div>
  <div id="kairiChart"></div>

  <!-- ğŸ¤– AIåˆ†æã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
  <div class="analysis-section">
      <!-- åˆ†æãƒ¢ãƒ¼ãƒ‰é¸æŠã‚¿ãƒ– -->
      <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 0; margin-bottom: 10px;">
          <div class="analysis-tabs" style="display: flex; align-items: center; flex-wrap: wrap; gap: 0;">
              <button class="tab-btn active" data-mode="full" title="Googleæ¤œç´¢ã§æœ€æ–°ã®æ±ºç®—ã‚„ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’èª¿æŸ»">ğŸ” å€‹åˆ¥æ ªåˆ†æ</button>
              <button class="tab-btn" data-mode="volume" title="å‡ºæ¥é«˜ãŒæ€¥å¢—ã—ãŸæ—¥ã®èƒŒæ™¯ã‚’èª¿æŸ»">ğŸ“Š å‡ºæ¥é«˜åˆ†æ</button>
              <button class="tab-btn" data-mode="tech" title="ãƒãƒ£ãƒ¼ãƒˆã®å½¢ã‹ã‚‰ä»Šå¾Œã®å±•é–‹ã‚’äºˆæ¸¬">ğŸ“ˆ ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æ</button>
              <button class="tab-btn" data-mode="market" title="æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‹ã‚‰å¸‚å ´å…¨ä½“ã‚’åˆ†æ">ğŸŒ å¸‚æ³åˆ†æ</button>
              <button class="tab-btn" data-mode="total" title="éå»ã®åˆ†æçµæœã‚’çµ±åˆã—ã¦å¤šè§’çš„ã«åˆ†æ">ğŸ’ ç·åˆåˆ†æ</button>
          </div>
      </div>

      <!-- ğŸŒ€ ãƒ¢ãƒ€ãƒ³ãªãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
      <div id="loading-container">
        <div class="loading-content">
          <div id="loading-spinner" class="loader"></div>
          <div id="loading-indicator" style="font-weight: bold; color: #0056b3; font-size: 0.95em;"></div>
        </div>
      </div>

      <!-- åˆ†æçµæœã®å‡ºåŠ›å ´æ‰€ -->
      <div id="analysis-container" style="display: none; background: #fff; padding: 25px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 20px;">
          <div id="analysisResult" style="border:none; padding:0; min-height: auto; margin-bottom: 20px;"></div>
          <div class="analyze-area" style="display: flex; justify-content: flex-end; gap: 10px;">
              <button id="exportPdfBtn" style="display: none; padding: 12px 20px; background: #6c757d; color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; transition: all 0.3s;">PDFä¿å­˜</button>
          </div>
      </div>

      <!-- ğŸŒ å¸‚æ³åˆ†æå°‚ç”¨ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒªã‚¢ -->
      <div id="market-form-area" style="display: none; background: #fff; padding: 20px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 20px; animation: fadeIn 0.3s;">
          <div class="market-category">
              <h4>ğŸ“ˆ ä¸»è¦æŒ‡æ¨™ãƒ»å…¨ä½“å¸‚æ³ <span class="help-icon" data-tooltip="ã€ä¸»è¦æŒ‡æ¨™ãƒ»å…¨ä½“å¸‚æ³ã®èª¬æ˜ã€‘
                ãƒ»æ—¥çµŒå¹³å‡: æ±è¨¼ãƒ—ãƒ©ã‚¤ãƒ ã®ä¸»è¦225éŠ˜æŸ„ã®å¹³å‡æ ªä¾¡
                ãƒ»ã‚°ãƒ­ãƒ¼ã‚¹: æ–°èˆˆä¼æ¥­ä¸­å¿ƒã®å¸‚å ´ã€‚é‡‘åˆ©ä¸Šæ˜‡å±€é¢ã«å¼±ã„
                ãƒ»S&P500: ç±³å›½ã®ä¸»è¦ä¼æ¥­500ç¤¾ã®æ ªä¾¡æŒ‡æ•°
                ãƒ»NASDAQ: ç±³å›½ã®ãƒã‚¤ãƒ†ã‚¯éŠ˜æŸ„ä¸­å¿ƒã®æŒ‡æ•°
                ãƒ»VIXæŒ‡æ•°: é€šç§°ææ€–æŒ‡æ•°ã€‚å¸‚å ´ã®ä¸å®‰ãŒé«˜ã¾ã‚‹ã¨ä¸Šæ˜‡
                ãƒ»ãƒ‰ãƒ«å††: ç±³ãƒ‰ãƒ«å††ã®ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã€‚æ—¥æœ¬å¸‚å ´ã¸ã®å½±éŸ¿å¤§
                ãƒ»å›½å‚µåˆ©å›ã‚Š: ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã®æœ€å¤§ã®å¤‰å‹•è¦å› ">?</span>
              </h4>
              <div class="market-grid">
                  <label><input type="checkbox" name="market_topic" value="æ—¥çµŒå¹³å‡"> æ—¥çµŒå¹³å‡</label>
                  <label><input type="checkbox" name="market_topic" value="ã‚°ãƒ­ãƒ¼ã‚¹"> ã‚°ãƒ­ãƒ¼ã‚¹</label>
                  <label><input type="checkbox" name="market_topic" value="S&P500"> S&P500</label>
                  <label><input type="checkbox" name="market_topic" value="NASDAQ"> NASDAQ</label>
                  <label><input type="checkbox" name="market_topic" value="VIX"> VIXæŒ‡æ•°</label>
                  <label><input type="checkbox" name="market_topic" value="ãƒ‰ãƒ«å††"> ãƒ‰ãƒ«å††</label>
                  <label><input type="checkbox" name="market_topic" value="æ—¥æœ¬å›½å‚µ"> æ—¥æœ¬å›½å‚µ</label>
                  <label><input type="checkbox" name="market_topic" value="ç±³å›½å‚µ"> ç±³å›½å‚µ</label>
              </div>
          </div>
          <div class="market-category">
              <h4>ğŸ¦ ãƒã‚¯ãƒ­çµŒæ¸ˆãƒ»é‡‘èæ”¿ç­– <span class="help-icon" data-tooltip="ã€ãƒã‚¯ãƒ­çµŒæ¸ˆãƒ»é‡‘èæ”¿ç­–ã®èª¬æ˜ã€‘
                  ãƒ»FRB: ç±³å›½ã®ä¸­å¤®éŠ€è¡Œã€‚ä¸–ç•ŒçµŒæ¸ˆã®èˆµå–ã‚Šå½¹
                  ãƒ»FOMC: ç±³å›½ã®é‡‘èæ”¿ç­–ã€‚ãã®å½±éŸ¿ã¯ä¸–ç•Œã«åŠã¶
                  ãƒ»æ—¥éŠ€: æ—¥æœ¬ã®ä¸­å¤®éŠ€è¡Œã€‚ç‰©ä¾¡ã¨é€šè²¨ã®å®‰å®šã‚’æ‹…ã†
                  ãƒ»åˆ©ä¸Šã’/åˆ©ä¸‹ã’: æ™¯æ°—ã‚„ç‰©ä¾¡ã‚’èª¿æ•´ã™ã‚‹é‡‘èæ”¿ç­–ã®åŸºæœ¬
                  ãƒ»ç±³é›‡ç”¨çµ±è¨ˆ: é‡‘èæ”¿ç­–åŠã³ä¸–ç•Œã®æ ªä¾¡ã«ç›´çµã™ã‚‹ãƒ‡ãƒ¼ã‚¿
                  ãƒ»ç±³CPI(ç±³æ¶ˆè²»è€…ç‰©ä¾¡æŒ‡æ•°): ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã‚’æ¸¬ã‚‹é‡è¦æŒ‡æ¨™">?</span>
              </h4>
              <div class="market-grid">
                  <label><input type="checkbox" name="market_topic" value="FRB"> FRB</label>
                  <label><input type="checkbox" name="market_topic" value="FOMC"> FOMC</label>
                  <label><input type="checkbox" name="market_topic" value="æ—¥éŠ€"> æ—¥éŠ€</label>
                  <label><input type="checkbox" name="market_topic" value="åˆ©ä¸Šã’"> åˆ©ä¸Šã’</label>
                  <label><input type="checkbox" name="market_topic" value="åˆ©ä¸‹ã’"> åˆ©ä¸‹ã’</label>
                  <label><input type="checkbox" name="market_topic" value="ç±³é›‡ç”¨çµ±è¨ˆ"> ç±³é›‡ç”¨çµ±è¨ˆ</label>
                  <label><input type="checkbox" name="market_topic" value="CPI"> ç±³CPI</label>
              </div>
          </div>
          <div class="market-category">
              <h4>ğŸš€ ä¸»è¦ã‚»ã‚¯ã‚¿ãƒ¼ãƒ¯ãƒ¼ãƒ‰ <span class="help-icon" data-tooltip="ã€æ³¨ç›®ã®ã‚»ã‚¯ã‚¿ãƒ¼ãƒ»ç”£æ¥­ã®èª¬æ˜ã€‘
                  ãƒ»åŠå°ä½“: ã‚ã‚‰ã‚†ã‚‹AIã‚„æ©Ÿæ¢°ã®æ ¸ã¨ãªã‚‹ç”£æ¥­
                  ãƒ»ç”ŸæˆAI: è¿‘å¹´å¸‚å ´è¦æ¨¡ã‚’æ€¥æ‹¡å¤§ã€‚ãƒãƒ–ãƒ«æ‡¸å¿µã®å™‚ã‚‚
                  ãƒ»ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿: AIãƒ»ã‚¯ãƒ©ã‚¦ãƒ‰ã®å½±éŸ¿ã§éœ€è¦æ€¥å¢—ä¸­
                  ãƒ»é˜²è¡›: è¿‘å¹´ã®ä¸–ç•Œçš„ãªãƒˆãƒ¬ãƒ³ãƒ‰ã€‚é˜²è¡›è²»ãŒéµ
                  ãƒ»é‡‘: å®‰å®šè³‡ç”£ã€‚æ™¯æ°—æ‡¸å¿µã‚„é€šè²¨ä¾¡å€¤ä¸‹è½å±€é¢ã§å¼·ã„
                  ãƒ»åŸæ²¹: çµŒæ¸ˆæ´»å‹•ã®åŸºæœ¬è³‡æºã€‚ç‰©ä¾¡ã‚„ä¼æ¥­æ¥­ç¸¾ã«ç›´çµ
                  ãƒ»ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³: æœ€ã‚‚ãƒ¡ã‚¸ãƒ£ãƒ¼ãªæš—å·è³‡ç”£ã€‚å€¤å‹•ããŒæ¿€ã—ã‚">?</span>
              </h4>
              <div class="market-grid">
                  <label><input type="checkbox" name="market_topic" value="åŠå°ä½“"> åŠå°ä½“</label>
                  <label><input type="checkbox" name="market_topic" value="ç”ŸæˆAI"> ç”ŸæˆAI</label>
                  <label><input type="checkbox" name="market_topic" value="ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿"> ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿</label>
                  <label><input type="checkbox" name="market_topic" value="é˜²è¡›æ ª"> é˜²è¡›</label>
                  <label><input type="checkbox" name="market_topic" value="é‡‘ä¾¡æ ¼"> é‡‘</label>
                  <label><input type="checkbox" name="market_topic" value="åŸæ²¹ä¾¡æ ¼"> åŸæ²¹</label>
                  <label><input type="checkbox" name="market_topic" value="ãƒ“ãƒƒãƒˆã‚³ã‚¤ãƒ³"> æš—å·è³‡ç”£</label>
              </div>
          </div>
          <div class="market-category">
              <h4>ğŸŒ ä¼æ¥­æ´»å‹•ãƒ¯ãƒ¼ãƒ‰ <span class="help-icon" data-tooltip="ã€ä¼æ¥­æ´»å‹•ãƒ»ãƒˆãƒ¬ãƒ³ãƒ‰ã®èª¬æ˜ã€‘
                ãƒ»æ±ºç®—ç™ºè¡¨: ä¼æ¥­ã®æ¥­ç¸¾å ±å‘Šã€‚æ ªä¾¡å¤‰å‹•ã®æœ€å¤§è¦å› 
                ãƒ»ä¸Šæ–¹/ä¸‹æ–¹ä¿®æ­£: æ¥­ç¸¾äºˆæƒ³ã®ä¿®æ­£ã€‚çªç„¶ç™ºè¡¨ã™ã‚‹ã“ã¨ã‚‚
                ãƒ»æ ªä¸»é‚„å…ƒ: æ ªä¸»ã«åˆ©ç›Šã‚’é‚„å…ƒã™ã‚‹æ´»å‹•å…¨èˆ¬
                ãƒ»å¢—é…: é…å½“ã‚’å¢—ã‚„ã™ã“ã¨ã€‚æ ªä¾¡ä¸‹æ”¯ãˆã®æœ€å¤§è¦å› 
                ãƒ»è‡ªç¤¾æ ªè²·ã„: è‡ªç¤¾æ ªã‚’è²·ã†ã“ã¨ã€‚è²·ä»˜æ•°ã‚„æœŸé–“ã‚‚é‡è¦">?</span>
              </h4>
              <div class="market-grid">
                  <label><input type="checkbox" name="market_topic" value="æ±ºç®—ç™ºè¡¨"> æ±ºç®—ç™ºè¡¨</label>
                  <label><input type="checkbox" name="market_topic" value="ä¸Šæ–¹ä¿®æ­£"> ä¸Šæ–¹ä¿®æ­£</label>
                  <label><input type="checkbox" name="market_topic" value="ä¸‹æ–¹ä¿®æ­£"> ä¸‹æ–¹ä¿®æ­£</label>
                  <label><input type="checkbox" name="market_topic" value="æ ªä¸»é‚„å…ƒ"> æ ªä¸»é‚„å…ƒ</label>
                  <label><input type="checkbox" name="market_topic" value="å¢—é…"> å¢—é…</label>
                  <label><input type="checkbox" name="market_topic" value="è‡ªç¤¾æ ªè²·ã„"> è‡ªç¤¾æ ªè²·ã„</label>
              </div>
          </div>
          <div class="market-category">
              <h4>ğŸ” è‡ªç”±ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ <span class="help-icon" data-tooltip="ã€è‡ªç”±ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã®èª¬æ˜ã€‘
                å…¥åŠ›ã•ã‚ŒãŸãƒ¯ãƒ¼ãƒ‰ã«å¾“ã£ã¦ãƒ‹ãƒ¥ãƒ¼ã‚¹èª¿æŸ»ã‚’è¡Œãªã„ã¾ã™ã€‚
                ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¨ã—ã¦å–ã‚Šä¸Šã’ã‚‰ã‚Œã«ãã„ãƒ¯ãƒ¼ãƒ‰ã®å ´åˆ
                æ­£å¸¸ã«åˆ†æçµæœãŒå‡ºåŠ›ã•ã‚Œãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚">?</span></h4>
              <input type="text" id="market_free_keyword" placeholder="ä¾‹: æ±äº¬è¨¼åˆ¸å–å¼•æ‰€" style="width: 100%; box-sizing: border-box; padding: 8px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px;">
              
              <details>
                  <summary>ğŸ“ ãã®ä»–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¡ˆï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å±•é–‹ï¼‰</summary>
                  <div class="details-content">
                      <div class="market-grid">
                          <label><input type="checkbox" name="market_topic" value="å††å®‰"> å††å®‰</label>
                          <label><input type="checkbox" name="market_topic" value="å††é«˜"> å††é«˜</label>
                          <label><input type="checkbox" name="market_topic" value="IMMé€šè²¨"> IMMé€šè²¨å…ˆç‰©</label>
                          <label><input type="checkbox" name="market_topic" value="ãƒ¦ãƒ¼ãƒ­"> ãƒ¦ãƒ¼ãƒ­</label>
                          <label><input type="checkbox" name="market_topic" value="ãƒãƒ³ãƒ‰"> ãƒãƒ³ãƒ‰</label>
                          <label><input type="checkbox" name="market_topic" value="ã‚¹ã‚¤ã‚¹ãƒ•ãƒ©ãƒ³"> ã‚¹ã‚¤ã‚¹ãƒ•ãƒ©ãƒ³</label>
                          <label><input type="checkbox" name="market_topic" value="æ–°èˆˆå›½"> æ–°èˆˆå›½</label>
                          <label><input type="checkbox" name="market_topic" value="æ—¥æœ¬æ”¿åºœ"> æ—¥æœ¬æ”¿åºœ</label>
                          <label><input type="checkbox" name="market_topic" value="ç±³æ”¿åºœ"> ç±³æ”¿åºœ</label>
                          <label><input type="checkbox" name="market_topic" value="æ¤ç”°ç·è£"> æ¤ç”°ç·è£</label>
                          <label><input type="checkbox" name="market_topic" value="ãƒ‘ã‚¦ã‚¨ãƒ«è­°é•·"> ãƒ‘ã‚¦ã‚¨ãƒ«è­°é•·</label>
                          <label><input type="checkbox" name="market_topic" value="GDP"> GDP</label>
                          <label><input type="checkbox" name="market_topic" value="æ™¯æ°—å¾Œé€€"> æ™¯æ°—å¾Œé€€</label>
                          <label><input type="checkbox" name="market_topic" value="äººå·¥çŸ¥èƒ½"> äººå·¥çŸ¥èƒ½</label>
                          <label><input type="checkbox" name="market_topic" value="éŠ€è¡Œ"> éŠ€è¡Œ</label>
                          <label><input type="checkbox" name="market_topic" value="é‡å­"> é‡å­</label>
                          <label><input type="checkbox" name="market_topic" value="è‡ªå‹•è»Š"> è‡ªå‹•è»Š</label>
                          <label><input type="checkbox" name="market_topic" value="åŸå­åŠ›"> åŸå­åŠ›</label>
                          <label><input type="checkbox" name="market_topic" value="ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰"> ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰</label>
                          <label><input type="checkbox" name="market_topic" value="ä¸­å›½é–¢é€£"> ä¸­å›½é–¢é€£</label>
                          <label><input type="checkbox" name="market_topic" value="ãƒã‚¤ãƒ†ã‚¯é–¢é€£"> ãƒã‚¤ãƒ†ã‚¯é–¢é€£</label>
                          <label><input type="checkbox" name="market_topic" value="æƒ…å ±é€šä¿¡"> æƒ…å ±é€šä¿¡</label>
                          <label><input type="checkbox" name="market_topic" value="å°å£²"> å°å£²</label>
                          <label><input type="checkbox" name="market_topic" value="å•†ç¤¾"> å•†ç¤¾</label>
                          <label><input type="checkbox" name="market_topic" value="ã‚²ãƒ¼ãƒ "> ã‚²ãƒ¼ãƒ </label>
                          <label><input type="checkbox" name="market_topic" value="ã‚¤ãƒ³ãƒ•ãƒ©"> ã‚¤ãƒ³ãƒ•ãƒ©</label>
                          <label><input type="checkbox" name="market_topic" value="å»ºè¨­"> å»ºè¨­</label>
                          <label><input type="checkbox" name="market_topic" value="TOB"> TOB</label>
                          <label><input type="checkbox" name="market_topic" value="M&A"> M&A</label>
                          <label><input type="checkbox" name="market_topic" value="IPO"> IPO</label>
                          <label><input type="checkbox" name="market_topic" value="åœ°æ”¿å­¦ãƒªã‚¹ã‚¯"> åœ°æ”¿å­¦ãƒªã‚¹ã‚¯</label>
                          <label><input type="checkbox" name="market_topic" value="å¼·æ°—ç›¸å ´"> å¼·æ°—ç›¸å ´</label>
                          <label><input type="checkbox" name="market_topic" value="å¼±æ°—ç›¸å ´"> å¼±æ°—ç›¸å ´</label>
                          <label><input type="checkbox" name="market_topic" value="æŠ¼ã—ç›®"> æŠ¼ã—ç›®</label>
                          <label><input type="checkbox" name="market_topic" value="åˆ©ç›Šç¢ºå®š"> åˆ©ç›Šç¢ºå®š</label>
                          <label><input type="checkbox" name="checkbox" name="market_topic" value="è¸ã¿ä¸Šã’"> è¸ã¿ä¸Šã’</label>
                      </div>
                  </div>
              </details>
          </div>

          <div class="market-category">
              <h4>âš™ï¸ ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®š <span class="help-icon" data-tooltip="ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šã®èª¬æ˜ã€‘
                  ãƒ»è©³ç´°åˆ†æ: ãƒªã‚¹ã‚¯è¦å› ï¼Œå¸‚å ´å¿ƒç†ï¼Œå¤‰å‹•å¹…ã‚‚åˆ†æ
                  ãƒ»æ¥­ç¨®åˆ¥åˆ†æ: å„æ¥­ç¨®ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ãŸåˆ†æ
                  ãƒ»çŸ­æœŸåˆ†æ: ç›´è¿‘1é€±é–“ã«çµã£ãŸåˆ†æ
                  ãƒ»ä¸­æœŸåˆ†æ: ç›´è¿‘1ãƒ¶æœˆé–“ã«çµã£ãŸåˆ†æ
                  ãƒ»ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æ: ç§»å‹•å¹³å‡ç·šï¼Œãƒˆãƒ¬ãƒ³ãƒ‰ï¼Œæ”¯æŒç·šï¼ŒæŠµæŠ—ç·šï¼Œå‡ºæ¥é«˜ã«ã¤ã„ã¦åˆ†æ
                  ãƒ»åˆå¿ƒè€…å‘ã‘èª¬æ˜: é‡‘èç”¨èªã«â€»å°ã®æ³¨é‡ˆã‚’ä»˜ä¸">?</span>
              </h4>
              <div class="market-grid">
                  <label><input type="checkbox" id="m_deep"> +è©³ç´°åˆ†æ</label>
                  <label><input type="checkbox" id="m_sector"> +æ¥­ç¨®åˆ¥åˆ†æ</label>
                  <label><input type="checkbox" id="m_short"> +çŸ­æœŸåˆ†æ</label>
                  <label><input type="checkbox" id="m_mid"> +ä¸­æœŸåˆ†æ</label>
                  <label><input type="checkbox" id="m_tech"> +ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æ</label>
                  <label><input type="checkbox" id="m_beginner"> +åˆå¿ƒè€…å‘ã‘</label>
              </div>
          </div>
      </div>

      <!-- å„åˆ†æãƒ¢ãƒ¼ãƒ‰ã®æ¡ˆå†…ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ï¼ˆå®Ÿè¡Œãƒœã‚¿ãƒ³ã‚’ä¸­ã«é…ç½®ï¼‰ -->
      <div id="full-analysis-guide" class="analysis-guide" style="background:#e3f2fd; padding:20px; border-radius:8px; margin-bottom:15px; border-left: 5px solid #2196f3; position: relative;">
          <h4 style="margin-top:0;">ğŸ” å€‹åˆ¥æ ªåˆ†æãƒ¢ãƒ¼ãƒ‰</h4>
          <p style="font-size:0.9em; margin-bottom:15px;">
              æœ€æ–°ã®æ±ºç®—æƒ…å ±ã€æ ªä¾¡å‹•å‘ã€éœ€çµ¦çŠ¶æ³ï¼ˆä¿¡ç”¨å€ç‡ï¼‰ã€ã‚¢ãƒŠãƒªã‚¹ãƒˆè©•ä¾¡ãªã©ã‚’Googleæ¤œç´¢ã‚’ç”¨ã„ã¦å¤šè§’çš„ã«èª¿æŸ»ãƒ»åˆ†æã—ã¾ã™ã€‚<br>
              ä¼æ¥­ã®ãƒ•ã‚¡ãƒ³ãƒ€ãƒ¡ãƒ³ã‚¿ãƒ«ã‚ºã«åŸºã¥ã„ãŸä¸­é•·æœŸçš„ãªæŠ•è³‡åˆ¤æ–­ã«æœ€é©ã§ã™ã€‚
          </p>
          <div style="display: flex; justify-content: flex-end;">
              <button class="run-analysis-trigger" data-mode="full" style="padding: 10px 25px; background: linear-gradient(135.22deg, #0078d7 0%, #0056b3 100%); color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 10px rgba(0,120,215,0.3);">å€‹åˆ¥æ ªåˆ†æã‚’å®Ÿè¡Œã™ã‚‹ ğŸš€</button>
          </div>
      </div>

      <div id="volume-analysis-guide" class="analysis-guide" style="display:none; background:#e3f2fd; padding:20px; border-radius:8px; margin-bottom:15px; border-left: 5px solid #2196f3; position: relative;">
          <h4 style="margin-top:0;">ğŸ“Š å‡ºæ¥é«˜åˆ†æãƒ¢ãƒ¼ãƒ‰</h4>
          <p style="font-size:0.9em; margin-bottom:15px;">
              éå»1å¹´é–“ã®å‡ºæ¥é«˜æ€¥å¢—æ—¥ã‚’ç‰¹å®šã—ã€ãã®æ—¥ã«å¸‚å ´ã§ã©ã®ã‚ˆã†ãªãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚„ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸã®ã‹ã€æŠ•è³‡å®¶å¿ƒç†ã¯ã©ã†å‹•ã„ãŸã®ã‹ã‚’èª¿æŸ»ã—ã¾ã™ã€‚<br>
              æ ªä¾¡ãŒå¤§ããå‹•ããã£ã‹ã‘ã¨ãªã£ãŸã€Œææ–™ã€ã‚’æ˜ã‚Šä¸‹ã’ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚
          </p>
          <div style="display: flex; justify-content: flex-end;">
              <button class="run-analysis-trigger" data-mode="volume" style="padding: 10px 25px; background: linear-gradient(135.22deg, #0078d7 0%, #0056b3 100%); color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 10px rgba(0,120,215,0.3);">å‡ºæ¥é«˜åˆ†æã‚’å®Ÿè¡Œã™ã‚‹ ğŸš€</button>
          </div>
      </div>

      <div id="tech-analysis-guide" class="analysis-guide" style="display:none; background:#e3f2fd; padding:20px; border-radius:8px; margin-bottom:15px; border-left: 5px solid #2196f3; position: relative;">
          <h4 style="margin-top:0;">ğŸ“ˆ ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æãƒ¢ãƒ¼ãƒ‰</h4>
          <p style="font-size:0.9em; margin-bottom:15px;">
              ç›´è¿‘1å¹´é–“ã®ãƒãƒ£ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆç§»å‹•å¹³å‡ç·šã®ä¹–é›¢ç‡ã‚„åæŸã€æ”¯æŒç·šãƒ»æŠµæŠ—ç·šï¼‰ã«åŸºã¥ãã€ç¾åœ¨ã®ãƒˆãƒ¬ãƒ³ãƒ‰ã¨ä»Šå¾Œã®å±•æœ›ã‚’AIãŒåˆ†æã—ã¾ã™ã€‚<br>
              å£²ã‚‰ã‚Œã™ããƒ»è²·ã‚ã‚Œã™ãã®åˆ¤æ–­ã‚„ã€å£²è²·ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®æ¤œè¨ã«æœ€é©ã§ã™ã€‚
          </p>
          <div style="display: flex; justify-content: flex-end;">
              <button class="run-analysis-trigger" data-mode="tech" style="padding: 10px 25px; background: linear-gradient(135.22deg, #0078d7 0%, #0056b3 100%); color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 10px rgba(0,120,215,0.3);">ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«åˆ†æã‚’å®Ÿè¡Œã™ã‚‹ ğŸš€</button>
          </div>
      </div>

      <div id="market-analysis-guide" class="analysis-guide" style="display:none; background:#e3f2fd; padding:20px; border-radius:8px; margin-bottom:15px; border-left: 5px solid #2196f3; position: relative;">
          <h4 style="margin-top:0;">ğŸŒ å¸‚æ³åˆ†æãƒ¢ãƒ¼ãƒ‰</h4>
          <p style="font-size:0.9em; margin-bottom:15px;">
              ä¸»è¦ãªçµŒæ¸ˆãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’é¸æŠã—ã€ãã‚Œã‚‰ãŒæ ªå¼å¸‚å ´å…¨ä½“ã‚„ç‰¹å®šã®ã‚»ã‚¯ã‚¿ãƒ¼ã«ã©ã®ã‚ˆã†ãªå½±éŸ¿ã‚’ä¸ãˆã¦ã„ã‚‹ã‹ã‚’æ§‹é€ çš„ã«åˆ†æã—ã¾ã™ã€‚<br>
              ãƒã‚¯ãƒ­çµŒæ¸ˆã®å‹•å‘ã‚„ã€ç¾åœ¨ã®ã€Œç›¸å ´ã®ãƒ†ãƒ¼ãƒã€ã‚’æŠŠæ¡ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚<br><br>
              â€»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’é¸æŠã—ã™ãã‚‹ã¨ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ãŒé©åˆ‡ã«æŠ½å‡ºã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
          </p>
          <div style="display: flex; justify-content: flex-end;">
              <button class="run-analysis-trigger" data-mode="market" style="padding: 10px 25px; background: linear-gradient(135.22deg, #0078d7 0%, #0056b3 100%); color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 10px rgba(0,120,215,0.3);">å¸‚æ³åˆ†æã‚’å®Ÿè¡Œã™ã‚‹ ğŸš€</button>
          </div>
      </div>

      <div id="total-analysis-guide" class="analysis-guide" style="display:none; background:#e3f2fd; padding:20px; border-radius:8px; margin-bottom:15px; border-left: 5px solid #2196f3; position: relative;">
          <h4 style="margin-top:0;">ğŸ’ ç·åˆåˆ†æãƒ¢ãƒ¼ãƒ‰</h4>
          <p style="font-size:0.9em; margin-bottom:15px;">
              ä¸‹ã®ã€Œåˆ†æå±¥æ­´ã€ã‹ã‚‰ã€çµ±åˆã—ã¦åˆ†æã—ãŸã„è¤‡æ•°ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’é¸æŠã—ã¦å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚<br>
              ç•°ãªã‚‹è¦–ç‚¹ã®æƒ…å ±ã‚’AIãŒæ•´ç†ãƒ»çµ±åˆã—ã€æœ€çµ‚çš„ãªæŠ•è³‡æˆ¦ç•¥ã‚’ææ¡ˆã—ã¾ã™ã€‚<br><br>
              ã€ã‚ªã‚¹ã‚¹ãƒ¡ã®ä½¿ã„æ–¹ã€‘<br>
              â¶éŠ˜æŸ„è©³ç´°ã‚’çŸ¥ã‚‹ãŸã‚ã«å„ç¨®åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’é¸æŠã—ã¦ç·åˆåˆ†æ<br>
              â·åŒæ¥­ä»–ç¤¾ã®å€‹åˆ¥æ ªåˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’è¤‡æ•°é¸æŠã—ã¦ç·åˆåˆ†æ

          </p>
          <div style="display: flex; justify-content: flex-end;">
              <button class="run-analysis-trigger" data-mode="total" style="padding: 10px 25px; background: linear-gradient(135.22deg, #0078d7 0%, #0056b3 100%); color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 10px rgba(0,120,215,0.3);">ç·åˆåˆ†æã‚’å®Ÿè¡Œã™ã‚‹ ğŸš€</button>
          </div>
      </div>

      <!-- ğŸ“œ åˆ†æå±¥æ­´ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div id="history-section" style="margin-top: 40px;">
          <h3 style="border-bottom: 2px solid #ddd; padding-bottom: 10px;">ğŸ“œ åˆ†æå±¥æ­´</h3>
          <div id="history-list">
              <!-- JSã§å±¥æ­´ã‚¢ã‚¤ãƒ†ãƒ ãŒè¿½åŠ ã•ã‚Œã‚‹ -->
              <p style="color: #999; font-style: italic;">ã¾ã å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
          </div>
      </div>
  </div>


  <!-- ğŸ“¦ Python(Flask)ã‹ã‚‰å…¨éŠ˜æŸ„ãƒ‡ãƒ¼ã‚¿ã‚’JavaScriptã¸å—ã‘æ¸¡ã— -->
  <script>
    const allStocks = JSON.parse('{{ stocks | tojson | safe }}');
  </script>
</body>
</html>
